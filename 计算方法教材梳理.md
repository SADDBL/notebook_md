# 数值计算

[toc]



## 绪论

### 误差与有效数字

#### 1 绝对误差与绝对误差界

设$x^*$为**精确值**，x为近似值。

##### 定义1 绝对误差

$$
e=x^*-x
$$

##### 定义2 绝对误差限

若
$$
|e|=|x^*-x|\leqslant \varepsilon
$$
则称$\varepsilon$为绝对误差限

误差估计的四则运算：
$$
\varepsilon(x_1\pm x_2)=\varepsilon(x_1)\pm\varepsilon(x_2)\\
\varepsilon(x_1x_2)\approx|x_1|\varepsilon(x_2)+|x_2|\varepsilon(x_1)\\
\varepsilon(\frac{x_1}{x_2})\approx\frac{|x_1|\varepsilon(x_2)+|x_2|\varepsilon(x_1)}{|x_2|^2}\\
\varepsilon(f(x_1,x_2,\ldots,x_n))\approx\sum^n_{i=1}|(\frac{\partial f}{\partial x_i})^*|\varepsilon(x_i^*)
$$


#### 2 避免有效数字的严重损失

+ 避免除数的绝对值**远小于**被除数

+ 避免**相近**的近似数**相减**
+ 防止大数“吃”小数
+ 简化计算步骤



## 第一章 插值

用给定的未知函数$f(x)$的若干点的函数值构造**近似函数**$\varphi(x)$成为==插值==，$\varphi(x)$称为插值==函数==。

构造插值函数需要关心的问题：

+ 插值函数是否**存在**
+ 插值函数是否**唯一**
+ 如何表示插值函数
+ 如何估计**被插函数**$f(x)$和插值函数$\varphi(x)$的误差

### 1.1 Lagrange插值多项式

#### 1.1.1 线性插值

##### 1 线性插值问题

给定两个插值点$(x_0,f(x_0))$，$(x_1,f(x_1))$，设插值函数为$L_1(x)$，则使用**两点式**表示：
$$
L_1(x)=\frac{x-x_1}{x_0-x_1}f(x_0)+\frac{x-x_0}{x_0-x_1}f(x_1)
$$
这种形式称为==Lagrange插值多项式==。

记$l_0(x)=\frac{x-x_1}{x_0-x_1}$，$l_1(x)=\frac{x-x_0}{x_0-x_1}$为==插值基函数==。

插值基函数满足：
$$
l_i(x_j)=\delta_{ij}=\begin{cases}1,\quad i=j\\0,\quad i\neq j \end{cases}
$$


##### 2 线性插值==误差==

###### 定理1.1 

记$L_1(x)$是以$\{ (x_0,f(x_0)),(x_1,f(x_1)) \}$ 为插值点的插值函数，设$f(x)$**一阶连续可导**，$f^{''}(x)$在$(a,b)$存在，则对任意$x\in[a,b]$，至少存在一点$\xi\in[a,b]$，使：
$$
R(x)=f(x)-L_1(x)=\frac{f^{''}(\xi)}{2!}(x-x_0)(x-x_1)\quad \xi\in[x_0,x_1]
$$

$R(x)$称为插值函数的==截断误差==或者==擦绘制余项==。

#### 1.1.2 二次插值

##### 1 二次插值问题

给定三个插值点$\{(x_i,f(x_i)),i=0,1,2\}$，其中$x_i$互不相等。使用插值基函数的方法构造二次插值多项式$L_2(x)$。

插值基函数为：
$$
l_i(x)=\frac{(x-x_j)(x-x_k)}{(x_i-x_j)(x_i-x_k)}
$$
得到：
$$
L_2(x)=\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}f(x_0)+\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}f(x_1)+\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}f(x_2)
$$

##### 2 二次插值函数误差

$$
R_2(x)=\frac{f^(3)(\xi)}{3!}(x-x_0)(x-x_1)(x-x_2)
$$

#### 1.1.3 一般情况

若有$n+1$个插值点，则插值函数为$n$次方程。

插值基函数为：
$$
l_i(x)=\prod^n_{j=0, j\neq i}\frac{x-x_j}{x_i-x_j}
$$
所以，n阶插值函数为：
$$
L_n(x)=\sum^n_{i=0}l_i(x)f(x_i)
$$

###### 拉格朗日余弦定理

类似**定理1.1**可得：
$$
R_n(x)=f(x)-L_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{k=0}^n(x-x_k)\quad \xi\in[a,b]
$$
通常称插值节点所界定的范围为==插值区间==：
$$
[\min_{0\leqslant i\leqslant n}x_i,\max_{0\leqslant i\leqslant n}x_i]
$$

#### 1.1.4 误差事后估计

+ 利用事后误差估计某结点的误差
+ 利用**多组插值函数余项**，构造**更准确**的插值函数，构造的插值函数为**高次方程**

若有三个结点$x_0,x_1,x_2$，构建插值函数$L_1^1(x),L_1^2(x)$，则：
$$
f(x)-L^1_1(x)=\frac{x-x_1}{x_2-x_1}[L_2^2(x)-L_1^1(x)]
$$
整理得：
$$
f(x)\approx L_2(x)=L^1_2(x)+\frac{x-x_1}{x_2-x_1}[L_1^2(x)-L_1^1(x)]
$$


### 1.2 牛顿插值

#### 1.2.1 差商

$f(x)$在$k+1$个点的==k阶差商==（也称==均商==）为：
$$
f[x_0,x_1,\cdots,x_k]=\frac{f[x_0,\cdots,x_{k-2},x_k]-f[x_0,\cdots,x_{k-1}]}{x_k-x_{k-1}}
$$
性质：

+ 差商可表示为**函数值**的线性组合：
  $$
  f[x_0,x_1,\cdots,x_k]=\sum_{j=0}^k\frac{f(x_j)}{(x_j-x)\cdots(x_j-x_j-1)(x_j-x_{j+1})\cdots(x_j-x_k)}
  =\sum_{j=0}^k\frac{f(x_j)}{\omega'_{k+1}(x_j)}
  $$

+ 差商与所含节点的**次序无关**，称为差商的==对称性==，所以，差商还可以表示为：
  $$
  f[x_0,x_1,\cdots,x_k]=\frac{f[x_1,\cdots,x_k]-f[x_0,\cdots,x_{k-1}]}{x_k-x_{0}}
  $$

+ 若$f(x)$在含有$x_0,x_1,\cdots,x_n$的区间$[a,b]$具有**n阶**导数，则存在$\xi\in[a,b]$，使得：
  $$
  f[x_0,\cdots,x_n]=\frac{f^{(n)}(\xi)}{n!}
  $$
  即，在工程中，对于**离散点**，可以用差商代替导数。

#### 1.2.2 牛顿插值公式

牛顿插值公式：
$$
N_n(x)=f[x_0]+(x-x_0)f[x_0,x_1]+\cdots+(x-x_0)(x-x_1)\cdots(x-x_{n-1})f[x_0,x_1,\cdots,x_n]
$$
余项：
$$
E_n(x)=R_n(x)=(x-x_0)(x-x_1)\cdots(x-x_n)f[x,x_0,\cdots,x_n]=f[x,x_0,\cdots,x_n]\omega_{n+1}(x)
$$
式中：
$$
f[x,x_0,\cdots,x_n]=\frac{f^{(n+1)}(\xi)}{(n+1)!}
$$
则近似函数为：
$$
f(x)=N_n(x)+E_n(x)
$$

### 1.3 埃尔米特插值

不少插值问题不仅要求在节点上函数值相等而且要求在某些节点上对应的的**导数值甚至高阶导数值**相等 这 种插值称为切触插值，又称==埃尔米特插值==。

对于结点$x_0,x_1$，要求$H_3(x_i)=y_i,H_3'(x_i)=u'_i$，则要求：

|               | 函数值 | 函数值 | 导数值 | 导数值 |
| ------------- | :----: | :----: | :----: | :----: |
|               | $x_0$  | $x_1$  | $x_0$  | $x_1$  |
| $\alpha_0(x)$ |   1    |   0    |   0    |   0    |
| $\alpha_1(x)$ |   0    |   1    |   0    |   0    |
| $\beta_0(x)$  |   0    |   0    |   1    |   0    |
| $\beta_1(x)$  |   0    |   0    |   0    |   1    |

构造函数：

$\alpha_0(x)=(ax+b)(x-x_1)^2$，在$x_1$处导数值为0，在$x_0$处等于1。
$\beta_0(x)=c(x-x_0)(x-x_1)^2$，在$x_1$处导数值为0，在$x_0$处函数值为0。

为了简便计算，还可以令：
$$
\alpha_i(x)=[a+b(x-x_i)](x-x_j)^2
$$
则插值函数：
$$
P_3(x)=y_0\alpha_0(x)+y_1\alpha_1(x)+y_0’\beta_0(x)+y_1’(x)\beta_1(x)
$$
观察上述函数形式可发现：

+ 若需要**导数值**为零，对应项需要二次
+ 若需要**函数值**为零，对应项需要一次
+ 高次导数则次数更高，不需要考虑导数则为0

### 1.4 分段线性插值

根据**龙格现象**，插值一般最多只用**三次插值**多项式。



### 1.5 样条函数

#### 三转角样条插值

以端点的**导数**为条件进行样条插值，解出内节点的**导数值**，设$f'(x_i)=m_i$，则**三次样条插值的$m$关系式**为：
$$
S(x)=\frac{1}{h_i^3}[(x_i+2x-3x_{x-1})(x-x_i)^2y_{i-1}+(3x_i-2x-x_{i-1})(x-x_{i-1})y_i]\\
+\frac{1}{h_i^2}[(x-x_{x-i})(x-x_i)^2m_{i-1}+(x-x_{x-i})^2(x-x_i)m_{i}]
$$
求解$m_i,i=0,1,\cdots,n$：

+ 通常，$m_0$和$m_n$会作为边界值给出

+ 对于$m_i,i=1,\cdots,n-1$：

  + 求解矩阵方程：

    ![image-20230307180740509](image-20230307180740509.png)

  + 上式中：
    $$
    h_i=x_i-x_{i-1}\quad i=1,\cdots,n
    $$

    $$
    \lambda_i=\frac{h_{i+1}}{h_i+h_{i+1}},\quad \mu_i=1-\lambda_i\quad i=1,\cdots,n
    $$

    $$
    g_i=3(\lambda_if[x_{i-1},x_i]+\mu_if[x_i,x_{x+1}])
    $$

  + 若边界条件为$S''(x_0)=y''_0,S''(x_n)=y''_b$，则有：
    $$
    2m_0+m_1=3f[x_0,x_1]-\frac{1}{2}h_1y_0''=g_0\\
    m_{n-1}+2m_n=3f[x_{n-1},x_n]+\frac{1}{2}h_ny_n''=g_n
    $$
    ![image-20230307181700223](image-20230307181700223.png)



## 第二章 数值积分

数值求积的基本思想是**积分中值定理**：
$$
\int_a^bf(x)dx=(b-a)f(\xi)
$$
只要对平均高度$f(\xi)$提供一种算法， 相应地便获得一种数值求积方法。

###### $\xi$ 算法一：矩形公式

用**区间中点**$c=\frac{a+b}{2}$近似$\xi$ ：
$$
\int_a^bf(x)dx\approx (b-a)f(\frac{a+b}{2})
$$


### 2.1 机械求积

在积分区间$[a,b]$上取一系列点$x_k$，则==机械求积公式==为：
$$
I=\int_a^bf(x)dx\approx \sum_{k=0}^nA_kf(x_k)=I_n
$$
评价求积公式的好坏的标准：==代数精度==和==余项方程==。

#### 代数精度

若机械求积公式对$f(x)=x^k(k=0,1,\cdots,m)$均能**准确成立，**而对$f(x)=x^{m+1}$不准确，则称机械求解公式为m次**代数精度**。

------

令$f(x)=x^k$准确成立，得：
$$
\begin{cases}
A_0+A_1+\cdots,A_n=b-a\\
A_0x_0+A_1x_1+\cdots,A_nx_n=\frac{b^2-a^2}{2}\\
\cdots\cdots\\
A_0x_0^m+A_1x_1^m+\cdots,A_nx_n^m=\frac{b^{m-1}-a^{m-1}}{m-1}
\end{cases}
$$
左侧系数矩阵为**范德蒙行列式**。说明，在求积公式**节点给定**的情况下，求积公式的**构造问题**本质上是个解线性方程组的代数问题。

### 2.2 Newton—Cotes公式

#### 2.2.1 插值型求积公式

要求：节点处函数值给定。

作插值多项式：
$$
p_n(x)=\sum_{k=0}^nf(x_k)l_k(x)
$$
则：
$$
\int_a^bf(x)dx\approx \int_a^bp_n(x)=\sum_{k=0}^n y_k\int_a^bl_k(x)=\sum_{k=0}^nA_kf(x_k)
$$
所以，对于插值型求积公式：
$$
A_k=\int_a^bl_k(x)=\int_a^b\prod_{j=0,j\neq k}\frac{x-x_j}{x_k-x_j}
$$

#### 2.2.2 Newton—Cotes积分公式

将$[a,b]$分成$n$等份，$h=\frac{b-a}{n}$，选取节点：
$$
x_k=a+kh(k=0,1,\cdots,n)
$$
又：
$$
A_k=(b-a)c^{(n)}_k
$$
则求积公式：
$$
\int_a^bf(x)dx\approx (b-a)\sum_{k=0}^nc_k^{(n)}f(x_0+kh)
$$
其中：$c_k^{(n)}$成为==科特斯系数==，上式成为==Newton—Cotes积分公式==。

截断误差：
$$
R_n[f]=\frac{1}{(n+1)!}\int_a^bf^{(n+1)}(\xi)\omega_{n+1}(x)dx
$$

###### n=1，梯形公式

$$
\int_a^bf(x)dx\approx (b-a)[\frac{1}{2}f(a)+\frac{1}{2}f(b)]
$$

###### n=2，辛普森公式或抛物线公式

科特斯系数：
$$
c_0^{(2)}=\frac{1}{6}\quad c_1^{(2)}=\frac{4}{6}\quad c_2^{(2)}=\frac{1}{6}\quad 
$$
则辛普森公式或抛物线公式：
$$
\int_a^bf(x)dx\approx (b-a)[\frac{1}{6}f(a)+\frac{4}{6}f(\frac{a+b}{2})+\frac{1}{6}f(b)]
$$

###### n=4，Newton—Cotes公式

$$
\int_a^bf(x)dx\approx (b-a)[\frac{7}{90}f(x_0)+\frac{32}{90}f(x_1)+\frac{12}{90}f(x_2)+\frac{32}{90}f(x_3)+\frac{7}{90}f(x_4)]
$$

其中：$x_k=a_0+kh$。

#### 2.2.3 几种低阶求积公式的代数精度

###### 定理：当$n$为偶数时，**牛顿-科特斯公式**至少有$n+1$次代数精度。

#### 2.2.4 几种低阶求积公式的余项



### 2.3 复化求积公式

#### 2.3.1 复化梯形公式

$$
T_n=\frac{h}{2}[f(a)+2\sum_{i=1}^{n-1}f(x_i)+f(b)]
$$

余项：
$$
R=\sum_{i=1}^{n-1}[-\frac{1}{12}h^3f''(\eta_i)],\eta_i\in[x_i,x_{i+1}]
$$
若$f''(x)$在$[a,b]$上连续，则：
$$
R=-\frac{1}{12}h^3f''(\eta)=-\frac{b-a}{12}h^2f''(\eta),\eta\in[a,b]
$$

#### 2.3.2 复化辛普森公式

记$[x_i,x_{i+1}]$的中点为$x_{i+\frac{1}{2}}$，则复化辛普森公式：
$$
S_n=\int_a^bf(x)dx\approx\frac{h}{6}[f(x_i)+4\sum_{i=0}^{n-1} f(x_{i+\frac{1}{2}})+2\sum_{i=1}^{n-1} f(x_i)+f(x_{i+1})]
$$
